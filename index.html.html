<!DOCTYPE html>
<html lang="es">
<head>
<meta charset="UTF-8">
<title>Factrick - Usuarios</title>
<style>
body { 
  margin:0; 
  font-family:Arial; 
  background:linear-gradient(135deg,#1c1c1c,#3d0066); 
  color:white; 
  display:flex; 
  justify-content:center; 
  align-items:center; 
  height:100vh; 
}
.box { 
  background: rgba(0,0,0,0.8); 
  padding:30px; 
  border-radius:15px; 
  box-shadow:0 0 20px rgba(255,0,255,0.4); 
  text-align:center; 
  width:350px; 
  display:none; 
}
.box.active { display:block; }
input, select, button { 
  margin:10px 0; 
  padding:10px; 
  border-radius:8px; 
  border:none; 
  width:90%; 
}
button { 
  background:#a200ff; 
  color:white; 
  cursor:pointer; 
  font-weight:bold; 
}
button:hover { background:#6d00aa; }
.topbar { 
  position:absolute; 
  top:10px; 
  right:10px; 
  background:#111; 
  padding:10px 20px; 
  border-radius:10px; 
  font-size:14px; 
  box-shadow:0 0 10px rgba(255,255,255,0.3); 
}
.result { margin-top:15px; font-weight:bold; color:#0f0; }
.section { margin-top:20px; background:rgba(255,255,255,0.05); padding:15px; border-radius:10px; }
a { color:#aaa; text-decoration:none; cursor:pointer; }
a:hover { color:#fff; }
.contact-icons svg { 
  margin:0 5px; 
  vertical-align:middle; 
  transition: transform 0.2s; 
}
.contact-icons svg:hover { transform: scale(1.2); }

/* --- LOGO --- */
.logo {
  display: block;
  margin: 0 auto 20px auto;
  width: 120px;
  height: auto;
  border-radius: 15px;
  box-shadow: 0 0 15px rgba(255, 0, 255, 0.5);
}

/* --- WhatsApp Log --- */
#whatsAppLog {
  margin-top:10px;
  max-height:100px;
  overflow-y:auto;
  text-align:left;
  background: rgba(255,255,255,0.1);
  padding:10px;
  border-radius:8px;
  font-size:12px;
}
</style>
</head>
<body>

<!-- LOGIN -->
<div class="box active" id="loginBox">
  <img src="WhatsApp Image 2025-08-26 at 5.14.23 AM.jpeg" alt="Logo Factrick" class="logo">
  <h2>Acceso</h2>
  <input type="text" id="userLogin" placeholder="Usuario">
  <input type="password" id="passLogin" placeholder="ContraseÃ±a">
  <button onclick="loginUser()">Entrar</button>
  <p id="loginError" style="color:red;display:none;">Credenciales incorrectas</p>
  <p><a onclick="showRegister()">Registrarse</a></p>
  <button onclick="window.location.href='admin.html'" 
          style="background:#f500ff; margin-top:10px; font-weight:bold;">
    ðŸ”‘ Acceso Admin
  </button>
</div>

<!-- REGISTER -->
<div class="box" id="registerBox">
  <h2>Registro</h2>
  <input type="text" id="userReg" placeholder="Usuario">
  <input type="password" id="passReg" placeholder="ContraseÃ±a">
  <button onclick="registerUser()">Registrar</button>
  <p><a onclick="showLogin()">Volver a Login</a></p>
</div>

<!-- PANEL USUARIO -->
<div class="box" id="panelBox">
  <div class="topbar" id="topbar"></div>
  <h2>Factrick Revendedor</h2>

  <div class="section">
    <h3>Generar Key</h3>
    <select id="producto">
      <option value="drip">Drip Client</option>
      <option value="hg">HG CHEAT</option>
    </select>
    <select id="tiempo">
      <option value="1">1 DÃ­a - $1</option>
      <option value="7">7 DÃ­as - $5</option>
      <option value="15">15 DÃ­as - $12</option>
      <option value="30">1 Mes - $25</option>
      <option value="365">1 AÃ±o - $50</option>
    </select>
    <button onclick="generarKey()">Generar</button>
    <div class="result" id="resultado"></div>

    <!-- Contacto -->
    <div class="contact-icons" style="margin-top:15px;">
      <a href="https://wa.me/573001234567" target="_blank" onclick="addWhatsAppLog('AbriÃ³ WhatsApp')">
        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 48 48">
          <path fill="#fff" d="M4.9,43.3l2.7-9.8C5.9,30.6,5,27.3,5,24C5,13.5,13.5,5,24,5c5.1,0,9.8,2,13.4,5.6
          C41,14.2,43,18.9,43,24c0,10.5-8.5,19-19,19c0,0,0,0,0,0h0c-3.2,0-6.3-0.8-9.1-2.3L4.9,43.3z"></path>
        </svg>
      </a>
      <a href="https://www.tiktok.com/@tu_usuario" target="_blank">
        <svg xmlns="http://www.w3.org/2000/svg" width="30" height="30" viewBox="0 0 50 50">
          <path d="M41,4H9C6.243,4,4,6.243,4,9v32c0,2.757,2.243,5,5,5h32c2.757,0,5-2.243,5-5V9C46,6.243,43.757,4,41,4z"/>
        </svg>
      </a>
    </div>

    <!-- WhatsApp Log -->
    <div id="whatsAppLog"></div>
  </div>

  <div class="section">
    <h3>Reset Key</h3>
    <input type="text" id="resetInput" placeholder="Introduce la key">
    <button onclick="resetKey()">Resetear</button>
    <div class="result" id="resetMsg"></div>
  </div>

  <button onclick="logout()">Cerrar SesiÃ³n</button>
</div>

<script>
// --- VARIABLES ---
const precios = { "1":1, "7":5, "15":12, "30":25, "365":50 };
let currentUser = null;

// ELEMENTOS
const loginBox = document.getElementById("loginBox");
const registerBox = document.getElementById("registerBox");
const panelBox = document.getElementById("panelBox");
const userLogin = document.getElementById("userLogin");
const passLogin = document.getElementById("passLogin");
const userReg = document.getElementById("userReg");
const passReg = document.getElementById("passReg");
const topbar = document.getElementById("topbar");
const resultado = document.getElementById("resultado");
const resetInput = document.getElementById("resetInput");
const resetMsg = document.getElementById("resetMsg");
const loginError = document.getElementById("loginError");
const productoSelect = document.getElementById("producto");
const tiempoSelect = document.getElementById("tiempo");
const whatsAppLog = document.getElementById("whatsAppLog");

// --- VISTAS ---
function showRegister(){ loginBox.classList.remove("active"); registerBox.classList.add("active"); }
function showLogin(){ registerBox.classList.remove("active"); loginBox.classList.add("active"); }

// --- REGISTRO ---
function registerUser(){
  const u = userReg.value.trim();
  const p = passReg.value.trim();
  if(!u||!p) return alert("Completa usuario y contraseÃ±a");
  let users = JSON.parse(localStorage.getItem("users")||"{}");
  if(users[u]) return alert("Usuario ya existe");
  users[u] = {pass:p, saldo:0};
  localStorage.setItem("users", JSON.stringify(users));
  alert("Usuario registrado");
  showLogin();
}

// --- LOGIN ---
function loginUser(){
  const u = userLogin.value.trim();
  const p = passLogin.value.trim();
  let users = JSON.parse(localStorage.getItem("users")||"{}");
  if(users[u] && users[u].pass===p){
    currentUser = u;
    localStorage.setItem("currentUser",currentUser);
    updatePanel();
    loadWhatsAppLog();
    loginBox.classList.remove("active");
    panelBox.classList.add("active");
    loginError.style.display="none";
  } else { loginError.style.display="block"; }
}

// --- PANEL ---
function updatePanel(){
  let users = JSON.parse(localStorage.getItem("users")||"{}");
  if(!currentUser || !users[currentUser]) return;
  topbar.innerText = `User: ${currentUser} | Saldo: $${users[currentUser].saldo}`;
}

// --- GENERAR KEY ---
function generarKey(){
  let users = JSON.parse(localStorage.getItem("users")||"{}");
  if(!currentUser || !users[currentUser]) return;
  let producto = productoSelect.value;
  let tiempoVal = tiempoSelect.value;
  let precio = precios[tiempoVal];
  if(users[currentUser].saldo < precio){
    resultado.innerText = "Saldo insuficiente";
    return;
  }
  users[currentUser].saldo -= precio;
  localStorage.setItem("users", JSON.stringify(users));
  updatePanel();
  let key = producto==="drip" ? "KEY-"+Math.floor(1000000000+Math.random()*9000000000)
                               : "HG-FACTRICK-"+Math.floor(10000+Math.random()*90000);
  resultado.innerText = "âœ… Key generada: "+key;
  addWhatsAppLog("GenerÃ³ key: "+key);
}

// --- RESET KEY ---
function resetKey(){
  let keyVal = resetInput.value.trim();
  resetMsg.innerText = keyVal.length>0 ? "ðŸ”„ Key correctamente reseteada" : "âš ï¸ Ingresa una key vÃ¡lida";
  if(keyVal.length>0) addWhatsAppLog("Resetear key: "+keyVal);
}

// --- LOGOUT ---
function logout(){
  currentUser=null;
  localStorage.removeItem("currentUser");
  panelBox.classList.remove("active");
  loginBox.classList.add("active");
}

// --- WHATSAPP LOG ---
function addWhatsAppLog(msg){
  if(!currentUser) return;
  let log = JSON.parse(localStorage.getItem("waLog")||"{}");
  if(!log[currentUser]) log[currentUser]=[];
  log[currentUser].push(new Date().toLocaleString()+" - "+msg);
  localStorage.setItem("waLog", JSON.stringify(log));
  loadWhatsAppLog();
}

function loadWhatsAppLog(){
  whatsAppLog.innerHTML="";
  if(!currentUser) return;
  let log = JSON.parse(localStorage.getItem("waLog")||"{}");
  if(log[currentUser]){
    log[currentUser].forEach(line=>{
      let div = document.createElement("div");
      div.textContent = line;
      whatsAppLog.appendChild(div);
    });
  }
}

// --- MANTENER SESIÃ“N ---
window.onload = function(){
  let savedUser = localStorage.getItem("currentUser");
  if(savedUser){
    currentUser = savedUser;
    updatePanel();
    loadWhatsAppLog();
    loginBox.classList.remove("active");
    panelBox.classList.add("active");
  }
};
</script>

</body>
</html>
